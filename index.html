<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>SignalJ</title>
  </head>

  <body>
  <a href="https://github.com/chanan/SignalJ"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/8b6b8ccc6da3aa5722903da7b58eb5ab1081adee/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png"></a>
    <a href="http://www.reactivemanifesto.org/"> <img style="border: 0; position: fixed; right: 0; top:0; z-index: 9000" src="//d379ifj7s9wntv.cloudfront.net/reactivemanifesto/images/ribbons/we-are-reactive-orange-right.png"> </a>
    <div id="container">
      <div class="inner">

        <header>
          <h1>SignalJ</h1>
          <h2>A port of SignalR ideas to PlayFramework and Akka</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/chanan/SignalJ/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/chanan/SignalJ/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/chanan/SignalJ" target="_blank" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">

<h2>
<a name="overview" class="anchor" href="#overview"><span class="octicon octicon-link"></span></a>Overview</h2>

<p>A port of <a href="http://asp.net/signalr">SignalR</a> to the PlayFramework using Actors.</p>

<h2>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h2>

<p>Jump right to some examples:</p>

<ul>
<li><a href="http://localhost:9000/test">Test page of various SignalJ functions</a></li>
<li><a href="http://localhost:9000/chat">A port of the Playframework websocket-chat sample app</a></li>
</ul>

<h2>
<a name="setup-instructions" class="anchor" href="#setup-instructions"><span class="octicon octicon-link"></span></a>Setup Instructions</h2>

<p>Add the following to your build.sbt:</p>

<pre><code>resolvers += "release repository" at "http://chanan.github.io/maven-repo/releases/"

resolvers += "snapshot repository" at "http://chanan.github.io/maven-repo/snapshots/"
</code></pre>

<p>Add to your libraryDependencies:</p>

<pre><code>"signalJ" %% "signalj" % "0.5.0"
</code></pre>

<h2>
<a name="instructions" class="anchor" href="#instructions"><span class="octicon octicon-link"></span></a>Instructions</h2>

<p><em>Note:</em> This is a work in progress! These are not the full instructions</p>

<h3>
<a name="interface" class="anchor" href="#interface"><span class="octicon octicon-link"></span></a>Interface</h3>

<p>Create an interface for the javascript functions in your page (all functions should return void). The method params can be complex types.</p>

<p>For example see: ChatPage.java or FirstTestPage.java in the hubs package.</p>

<h3>
<a name="hubs" class="anchor" href="#hubs"><span class="octicon octicon-link"></span></a>Hubs</h3>

<p>Create a hub class that extends <code>Hub&lt;TInterface&gt;</code> where TInterface is the interface created above. You must also override
<code>getInterface()</code> and return the interface class.</p>

<h3>
<a name="javascript" class="anchor" href="#javascript"><span class="octicon octicon-link"></span></a>Javascript</h3>

<p>On your javascript page you must first make a connection to the hub. For example: <code>test.scala.html</code>:</p>

<pre><code>var hub = $.connection.helloWorld;
</code></pre>

<p>You can use <code>hub.client</code> to setup the callback that the server will use into your page:</p>

<pre><code>hub.client.firstTestFunctionWithParam = function(param) {
    console.log("Called from server with param: " + param);
};
</code></pre>

<p>You may then start the hub, which will start the websocket connection. This will return a promise which can be used to setup server calls:</p>

<pre><code>$.connection.hub.start().done(function () {
    $('#btnHello').click(function() {
        hub.server.sayHello();
    });
    ...
});
</code></pre>

<p>Also, as seen in the example above, <code>hub.server</code> is used to call into the hub serverside methods.</p>

<p>Server side method may also return a value which is return in a promise like so:</p>

<pre><code>$('#btnAdd').click(function() {
    hub.server.add(1, 2).done(function(result) {
        $('#result').html(result);
    });
});
</code></pre>

<h3>
<a name="calling-back-to-the-page" class="anchor" href="#calling-back-to-the-page"><span class="octicon octicon-link"></span></a>Calling back to the page</h3>

<p>The methods of the interface you defined become methods you can call from the hub. For example, if you defined a method in your interface
    called "myMethod()":</p>

<ul>
<li>
<code>clients().all.myMethod()</code> - executes <code>myMethod</code> on all clients</li>
<li>
<code>clients().others.myMethod()</code> - executes <code>myMethod</code> on all clients other than the caller</li>
<li>
<code>clients().caller.myMethod()</code> - executes <code>myMethod</code> on the caller</li>
<li>
<code>clients().client(conenctionId).myMethod()</code> - executes <code>myMethod</code> on a specific client</li>
<li>
<code>clients().allExcept.myMethod()</code> - executes <code>myMethod</code> on a all clients excepts the specified list of clients</li>
</ul>

<p>Hub classes are instantiated on every call. Therefore, they are thread safe. Hubs can't store data unless it is in a static variable.
In that case you need to ensure thread safety of the data. A future version of SignalJ may allow Actors to be hubs.</p>

<h3>
<a name="groups" class="anchor" href="#groups"><span class="octicon octicon-link"></span></a>Groups</h3>

<h4>
<a name="group-management" class="anchor" href="#group-management"><span class="octicon octicon-link"></span></a>Group management</h4>

<p>Groups can be used to group user together. Groups get created when the first user joins and get deleted when the last user leaves.</p>

<p>Groups can be managed server side from within the hub:</p>

<ul>
<li>
<code>groups().add(getConnectionId(), group)</code> - Adds a connection to a group</li>
<li>
<code>groups().remove(getConnectionId(), group)</code> - Removes a connection to a group</li>
</ul>

<p>(<em>NOTE:</em> the following is disabled for now in order to match up with SignalR) Group membership can also be accessed from javascript (<em>Note:</em> the javascript syntax <em>will</em> change
in future versions prior to 1.0 release.):</p>

<ul>
<li>
<code>groupAdd(group)</code> - Adds the current caller to a group</li>
<li>
<code>groupRemove(group)</code> - Removes the current caller to a group</li>
</ul>

<h4>
<a name="group-communication" class="anchor" href="#group-communication"><span class="octicon octicon-link"></span></a>Group communication</h4>

<p>You can invoke javascript functions to pages in a group with the following commands (as before calling <code>myMethod()</code>):</p>

<ul>
<li>
<code>clients().group(group).myMethod()</code> - Invokes <code>myMethod</code> on clients that are part of the group</li>
<li>
<code>clients().group(group, getConnectionId()).myMethod()</code> - Invokes <code>myMethod</code> on clients that are part of the group except the listed connections</li>
<li>
<code>clients().inGroupExcept(group, getConnectionId()).myMethod()</code> - Alias for above syntax</li>
<li>
<code>clients().othersInGroup(group).myMethod()</code> - Invokes <code>myMethod</code> on clients that are part of the group other than the caller</li>
</ul>

<h3>
<a name="accessing-the-hub-methods-from-outside-the-hub" class="anchor" href="#accessing-the-hub-methods-from-outside-the-hub"><span class="octicon octicon-link"></span></a>Accessing the hub methods from outside the hub</h3>

<p>You can access the hub from outside the hub by calling <code>getHub</code> on the <code>GlobalHost</code>. You can see this for example,
in the <code>actors.Robot</code> which is used in the Chat example:</p>

<p><code>HubContext&lt;ChatPage&gt; hub = GlobalHost.getHub(Chat.class);</code></p>

<h3>
<a name="dependency-injection" class="anchor" href="#dependency-injection"><span class="octicon octicon-link"></span></a>Dependency Injection</h3>

<p>You may use dependency injection for your hub classes. To do so, implement <code>DependencyResolver</code> (for example:
        hubs.GuiceDependencyResolver). In your app's <code>Global.onStart</code> set the resolver in the GlobalHost:</p>

<div class="highlight highlight-java"><pre><span class="n">GuiceDependencyResolver</span> <span class="n">resolver</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">GuiceDependencyResolver</span><span class="o">(</span><span class="n">injector</span><span class="o">);</span>
<span class="n">GlobalHost</span><span class="o">.</span><span class="na">setDependencyResolver</span><span class="o">(</span><span class="n">resolver</span><span class="o">);</span>
</pre></div>

<h2>
<a name="examples-1" class="anchor" href="#examples-1"><span class="octicon octicon-link"></span></a>Examples</h2>

<p>Examples of how hubs and pages can talk to each other using group and client communication can be found in the hubs.Helloworld which
can be accessed at: <a href="http://localhost:9000/test">http://localhost:9000/test</a> and hubs.Chat which can be accessed at
<a href="http://localhost:9000/Chat">http://localhost:9000/Chat</a> (Which is a rewrite of the playframework websocket-chat example).</p>

<h2>
<a name="future-changes" class="anchor" href="#future-changes"><span class="octicon octicon-link"></span></a>Future changes</h2>

<ul>
<li>Add supervision</li>
<li>better exceptions</li>
<li>SSE</li>
<li>Long polling</li>
<li>Forever Frames</li>
<li>Clustering</li>
</ul>
        </section>

        <footer>
          Signalj is maintained by <a href="https://github.com/chanan">chanan</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-56303263-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>
